@if(vm$() | async; as d){
<div class="table-card-wrapper">
  <div class="table-controls d-flex justify-content-between mb-2">
    <input class="form-control" placeholder="Axtar..." (input)="updateFilter($any($event.target).value)" />
    <small class="text-muted">Səh. ölçüsü: {{ state.pageSize }}</small>
  </div>

  <table class="table table-hover">
    <thead>
      <tr>
        @for (col of columns; track col.key) {
        <th (click)="col.sortable && changeSort($any(col.key))">
          {{ col.label }}
          @if(col.sortable){
          <span class="sort" [class]="state.sortDir"></span>
          }
        </th>
        }
        <th></th>
      </tr>
    </thead>

    <tbody>
      @for (r of d.rows; track ($any(r).id)) {
      <tr>
        @for (col of columns; track col.key) {
        <td>{{ col.cell ? col.cell(r) : r[col.key] }}</td>
        }
        <td>
          <button class="btn btn-sm btn-outline-danger" (click)="action.emit({ type: 'delete', row: r })">
            Sil
          </button>
        </td>
      </tr>
      }

      @if (d.rows.length === 0) {
      <tr>
        <td [attr.colspan]="columns.length + 1" class="text-center text-muted p-3">
          Məlumat tapılmadı
        </td>
      </tr>
      }
    </tbody>
  </table>

  <div class="d-flex justify-content-between align-items-center mt-2">
    <small class="text-muted">Ümumi: {{ d.total }}</small>

    <ul class="pagination">
      <li class="page-item" [class.disabled]="d.page === 1">
        <a class="page-link" (click)="goToPage(1)">«</a>
      </li>
      <li class="page-item" *ngFor="let _ of [].constructor(d.totalPages); index as idx"
        [class.active]="d.page === idx + 1">
        <a class="page-link" (click)="goToPage(idx + 1)">{{ idx + 1 }}</a>
      </li>
      <li class="page-item" [class.disabled]="d.page === d.totalPages">
        <a class="page-link" (click)="goToPage(d.totalPages)">»</a>
      </li>
    </ul>
  </div>
</div>
}